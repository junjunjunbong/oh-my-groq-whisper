<Window x:Class="GroqWhisperPTT.UI.OverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Groq Whisper PTT"
        Width="400"
        Height="200"
        MinWidth="300"
        MinHeight="150"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="CanResizeWithGrip"
        WindowStartupLocation="Manual"
        KeyDown="Window_KeyDown">

    <Grid>
        <!-- Main Border with Shadow -->
        <Border Background="#FF2D2D30" 
                BorderBrush="#FF007ACC" 
                BorderThickness="2" 
                CornerRadius="8"
                Margin="10">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="5" BlurRadius="15" Opacity="0.5"/>
            </Border.Effect>

            <Grid Margin="15">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header with Close Button -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock x:Name="StatusText" 
                               Grid.Column="0"
                               Text="● Recording…" 
                               FontSize="16" 
                               FontWeight="Bold"
                               Foreground="#FF007ACC"
                               VerticalAlignment="Center"/>
                    
                    <Button x:Name="TitleCloseButton"
                            Grid.Column="1"
                            Content="✕"
                            FontSize="12"
                            FontWeight="Bold"
                            Foreground="#FFCCCCCC"
                            Background="Transparent"
                            BorderThickness="0"
                            Padding="4,0,0,0"
                            Width="24"
                            Height="24"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Click="CloseButton_Click"
                            MouseEnter="TitleCloseButton_MouseEnter"
                            MouseLeave="TitleCloseButton_MouseLeave"/>
                </Grid>

                <!-- Content Area -->
                <Grid Grid.Row="1">
                    <!-- Recording Indicator -->
                    <StackPanel x:Name="RecordingPanel" Orientation="Horizontal" HorizontalAlignment="Center">
                        <Ellipse x:Name="RecordingDot" Width="20" Height="20" Fill="Red" Margin="0,0,10,0">
                            <Ellipse.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0.3" Duration="0:0:0.5" AutoReverse="True"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Ellipse.Triggers>
                        </Ellipse>
                        <TextBlock x:Name="RecordingText" Text="Recording..." Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Transcribing Indicator -->
                    <StackPanel x:Name="TranscribingPanel" Orientation="Horizontal" HorizontalAlignment="Center" Visibility="Collapsed">
                        <TextBlock x:Name="TranscribingText" Text="Transcribing…" Foreground="#FFCCCCCC" FontSize="18" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Text Editing Area -->
                    <TextBox x:Name="TranscriptionTextBox"
                             Visibility="Collapsed"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"
                             Background="#FF1E1E1E"
                             Foreground="White"
                             BorderBrush="#FF3E3E42"
                             Padding="8"
                             FontSize="14"
                             CaretBrush="White"/>

                    <!-- Error Display -->
                    <StackPanel x:Name="ErrorPanel" Orientation="Vertical" HorizontalAlignment="Center" Visibility="Collapsed">
                        <TextBlock x:Name="ErrorText" Text="Error occurred" Foreground="#FFFF6B6B" FontSize="14" TextWrapping="Wrap" TextAlignment="Center"/>
                        <Button x:Name="RetryButton" Content="Retry" Margin="0,10,0,0" Padding="15,5" Click="RetryButton_Click"/>
                    </StackPanel>
                </Grid>

                <!-- Footer Buttons -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button x:Name="CopyButton" 
                            Content="Copy (Ctrl+C)" 
                            Padding="15,6"
                            Margin="0,0,8,0"
                            Click="CopyButton_Click"
                            Visibility="Collapsed"/>
                    <Button x:Name="CloseButton" 
                            Content="Close (Esc)" 
                            Padding="15,6"
                            Click="CloseButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Resize Grip Visual Indicator -->
        <ResizeGrip HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                    Margin="12,12,14,14" 
                    Opacity="0.5"
                    IsHitTestVisible="False"/>
    </Grid>
</Window>
